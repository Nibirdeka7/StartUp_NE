import { useEffect, useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { X, MapPin, Users, TrendingUp, Loader2 } from "lucide-react";
import { supabase } from "../utils/supabaseClient";

const statePaths = {
  sikkim: "M534.803,234.042L535.365,234.696L537.569,234.716L539.708,236.331L539.796,238.41L540.449,238.633L541.089,240.258L540.266,241.429L540.066,245.287L537.987,248.004L539.092,252.181L542.047,254.242L541.441,255.585L538.877,256.3L538.54,257.915L537.585,258.898L537.585,258.898L536.875,259.151L535.827,258.062L535.096,258.528L534.118,257.862L532.549,257.839L531.549,258.115L531.789,258.848L529.228,260.639L526.401,260.03L525.896,259.411L524.015,259.642L523.05,259.212L521.508,259.717L520.18,259.073L519.895,257.522L518.379,257.052L518.379,257.052L519.745,254.001L519.098,253.082L519.228,252.18L520.096,251.626L519.147,249.813L523.162,242.108L522.529,241.332L523.267,240.885L523.135,240.462L521.333,239.729L521.175,237.916L521.571,237.587L522.867,238.104L523.94,237.471L524.312,237.978L526.96,236.907L528.125,237.205L530.565,235.44L532.024,235.616L532.429,234.415L534.051,233.922L533.929,233.244z",
  nagaland: "M706.028,261.65L707.03,265.626L705.74,266.306L706.371,266.675L706.542,268.043L707.319,268.332L706.568,269.692L707.129,270.973L707.129,270.973L704.962,272.719L704.957,273.73L702.674,276.849L703.693,277.673L703.657,278.424L704.467,278.775L704.087,282.673L704.644,283.313L704.003,284.497L704.069,286.044L705.772,286.813L703.701,289.745L701.877,290.61L701.479,291.291L701.321,292.258L702.291,295.117L699.286,297.565L698.818,299.077L698.016,299.549L698.434,300.228L696.98,300.396L696.017,302.104L692.616,303.036L692.616,303.036L691.323,302.88L689.349,301.65L689.305,299.739L690.336,298.223L689.836,298.201L690.347,296.983L689.756,296.816L687.988,298.925L687.169,298.804L686.021,299.559L685.764,300.868L682.974,302.128L682.273,301.678L680.394,301.977L679.872,300.612L678.964,300.539L678.404,301.363L677.186,301.128L677.025,300.422L675.161,299.47L675.05,300.119L673.868,300.504L671.953,300.194L668.782,300.931L668.655,301.985L669.655,302.008L669.783,302.882L667.407,305.601L666.747,305.601L664.531,309.772L663.138,308.504L661.841,308.672L661.99,307.849L661.1,307.759L661.028,306.968L660.45,306.056L661.138,305.123L660.711,303.691L658.986,302.921L657.31,300.76L659.813,298.547L661.705,297.891L663.622,295.166L667.079,292.87L666.613,291.28L668.291,290.576L668.845,289.801L669.506,291.273L669.022,292.93L669.439,293.766L670.656,292.504L671.712,292.941L672.579,291.85L674.239,291.012L673.598,288.722L674.545,287.015L674.903,284.384L677.602,280.38L679.366,279.915L679.653,276.875L682.012,274.305L682.353,274.167L682.46,276.346L683.052,276.812L683.956,275.618L685.219,274.998L685.439,272.854L686.867,272.302L687.01,271.403L689.025,270.33L689.8,270.85L690.57,269.588L691.202,270.128L692.726,269.763L695.747,267.842L697.943,264.538L699.04,264.025L700.543,264.91L701.476,264.723L703.795,263.637z",
  mizoram: "M630.251,334.613L633.538,334.576L633.91,337.21L635.066,337.499L635.197,336.954L636.391,336.556L636.891,334.765L638.484,334.571L638.815,332.498L640.552,331.918L642.5,327.578L644.167,331.319L645.053,330.75L646.159,330.882L646.324,330.401L646.956,330.854L648.65,330.653L648.65,330.653L649.273,330.986L649.201,332.128L649.771,332.217L648.852,333.861L649.221,335.703L648.02,338.191L650.041,338.823L650.715,338.501L651.275,340.015L652.504,338.891L653.076,339.757L654.303,339.885L654.488,338.997L655.121,338.963L655.606,339.619L655.311,340.571L656.171,339.846L657.456,339.798L657.456,339.798L657.379,341.536L659.059,343.016L659.232,347.424L660.263,349.496L659.021,356.007L659.465,357.191L658.199,358.066L658.955,361.472L658.413,363.404L658.928,363.71L656.42,367.181L655.257,367.165L653.722,365.758L652.112,366.091L652.015,367.313L653.037,369.448L652.265,369.604L651.675,372.136L651.231,372.29L651.583,374.02L651.035,374.932L652.411,377.818L651.558,379.573L652.132,379.883L652.352,381.365L653.625,382.304L654.09,386.65L652.482,387.029L653.076,388.244L652.674,388.815L650.65,387.98L649.856,388.309L650.352,390.807L648.983,390.803L648.879,393.894L648.323,393.92L647.481,392.691L646.85,393.016L646.308,394.88L645.18,391.765L644.576,391.816L641.263,389.485L640.778,389.596L640.386,393.006L638.434,394.079L638.311,391.967L637.407,390.1L637.858,389.823L638.442,390.303L638.544,388.954L636.39,378.773L636.396,376.323L635.865,374.218L635.165,373.862L634.461,372.009L634.196,370.114L633.813,370.289L633.514,369.422L632.311,369.037L632.788,365.813L632.059,364.563L631.936,361.124L633.18,360.901L632.244,358.893L632.44,357.858L630.945,354.949L630.344,350.989L629.854,350.865L630.216,349.226L629.516,348.288L629.516,348.288L629.278,346.029L629.994,345.983L629.679,345.14L630.129,344.554L630.866,344.701L631.153,343.499L630.639,342.225L631.099,341.465L630.708,340.286L631.302,337.356z",
  manipur: "M661.028,306.968L661.1,307.759L661.99,307.849L661.841,308.672L663.138,308.504L664.531,309.772L666.747,305.601L667.407,305.601L669.783,302.882L669.655,302.008L668.655,301.985L668.782,300.931L671.953,300.194L673.868,300.504L675.05,300.119L675.161,299.47L677.025,300.422L677.186,301.128L678.404,301.363L678.964,300.539L679.872,300.612L680.394,301.977L682.273,301.678L682.974,302.128L685.764,300.868L686.021,299.559L687.169,298.804L687.988,298.925L689.756,296.816L690.347,296.983L689.836,298.201L690.336,298.223L689.305,299.739L689.349,301.65L691.323,302.88L692.616,303.036L692.616,303.036L692.392,304.173L691.277,304.929L690.079,309.414L694.27,311.482L694.179,314.393L693.157,315.622L693.574,316.557L691.45,319.174L690.746,322.317L689.181,322.464L688.671,324.662L686.945,326.148L686.008,328.297L685.323,328.443L685.336,330.185L684.328,330.746L684.799,331.276L683.309,332.333L683.352,333.549L681.645,336.809L681.189,340.037L679.9,342.82L679.241,342.89L678.998,345.042L677.983,345.304L677.29,343.975L673.57,342.494L672.347,342.313L669.966,343.026L668.424,340.945L664.861,340.821L664.412,341.989L663.369,341.466L662.103,342.574L660.893,341.875L659.497,339.123L657.887,338.64L657.368,338.837L657.456,339.798L657.456,339.798L656.171,339.846L655.311,340.571L655.606,339.619L655.121,338.963L654.488,338.997L654.303,339.885L653.076,339.757L652.504,338.891L651.275,340.015L650.715,338.501L650.041,338.823L648.02,338.191L649.221,335.703L648.852,333.861L649.771,332.217L649.201,332.128L649.273,330.986L648.65,330.653L648.65,330.653L649.661,330.446L649.572,328.203L650.537,326.526L650.234,326.167L651.435,325.938L650.609,325.608L651.375,323.539L650.621,322.625L651.44,321.8L651.508,320.026L651.844,319.762L652.635,320.548L653.797,319.986L653.792,318.805L654.626,318.26L655.258,317.175L654.91,316.652L655.496,316.325L655.142,314.561L655.647,313.755L656.6,313.799L657.414,312.548L658.798,308.625z",
  meghalaya: "M566.821,300.827L570.669,299.312L567.409,295.84L568.479,295.59L569.046,294.808L568.769,293.5L570.434,292.917L570.79,292.428L570.34,292.084L573.318,289.925L574.987,290.365L578.695,289.583L579.757,288.643L580.581,288.543L581.421,289.199L582.693,288.514L584.188,290.01L583.614,291.625L585.442,289.964L586.659,290.548L586.071,291.206L586.549,291.556L588.15,290.199L589.754,290.028L589.575,291.129L590.555,291.311L591.387,290.164L592.09,290.528L593.298,290.174L594.242,291.179L594.158,290.398L594.86,290.283L595.506,291.862L597.121,291.839L596.377,293.559L597.64,292.866L598.409,292.766L597.661,293.386L598.011,293.608L601.493,292.599L601.06,294.76L601.375,295.982L602.209,296.143L603.562,295.528L605.076,293.126L607.307,292.71L607.974,293.068L610.092,292.235L610.204,291.797L609.631,292.378L608.768,292.279L610.247,290.908L609.47,290.984L611.41,288.047L612.881,288.327L613.033,289.832L612.333,290.483L613.853,291.386L615.183,290.113L615.472,287.365L617.773,285.81L619.25,286.358L619.103,287.549L620.461,288.925L622.264,287.84L623.878,288.055L625.977,287.713L627.158,286.835L628.801,287.277L630.27,286.844L626.584,290.356L626.775,291.219L628.392,291.343L627.199,292.307L626.499,293.808L626.698,297.491L628.483,296.332L631.217,296.096L632.563,295.354L633.82,295.933L633.794,296.99L634.664,297.213L635.611,298.77L637.073,299.055L637.462,300.404L638.249,300.483L639.579,299.573L639.35,301.005L637.329,302.833L638.133,302.724L638.42,304.164L639.6,303.674L639.752,304.327L640.109,304.149L641.269,305.251L641.764,305.087L642.378,306.289L643.002,306.361L643.205,307.598L642.485,308.536L643.525,309.32L639.93,310.424L638.747,311.976L636.212,311.394L636.689,312.449L635.157,312.229L634.607,314.083L633.631,314.221L633.631,314.221L631.572,313.689L631.59,313.008L628.603,312.518L624.254,310.088L616.796,310.655L616.036,310.353L615.805,311.101L614.847,310.902L613.205,311.845L612.188,311.242L612.496,310.455L608.749,311.555L607.332,310.607L605.305,310.551L603.514,309.712L598.513,309.89L592.879,310.972L590.748,310.244L589.542,311.017L588.327,310.566L583.723,310.477L582.042,311.275L579.144,309.995L573.228,309.121L569.465,307.131L565.884,307.324L566.228,306.943L565.555,304.979L566.429,302.609L566.429,302.609L567.079,302.28z",
  tripura: "M627.338,327.524L628.535,328.016L628.535,328.016L628.538,329.158L629.62,331.277L628.062,334.676L630.251,334.613L630.251,334.613L631.302,337.356L630.708,340.286L631.099,341.465L630.639,342.225L631.153,343.499L630.866,344.701L630.129,344.554L629.679,345.14L629.994,345.983L629.278,346.029L629.516,348.288L629.516,348.288L628.966,348.404L628.354,350.151L628.188,349.162L627.374,348.76L627.211,347.924L626.761,347.999L624.344,350.482L623.102,350.134L622.069,348.258L621.508,348.312L620.988,349.51L621.849,354.722L620.977,355.071L620.976,355.895L619.975,355.795L618.507,356.872L616.611,360.065L618.195,364.839L617.665,365.508L616.706,365.591L615.283,367.628L614.611,367.264L613.404,367.543L612.168,368.483L611.199,368.057L609.361,363.331L609.712,362.575L608.754,362.397L609.06,361.786L608.374,360.676L607.433,360.668L606.522,362.642L607.388,365.785L606.229,365.66L604.992,363.211L605.043,360.727L604.366,359.738L604.763,359.435L604.127,358.943L604.869,357.862L604.111,358.066L602.991,354.532L601.765,353.799L602.056,352.999L601.571,353.009L600.691,351.591L600.572,349.804L601.556,350.422L601.848,349.36L600.494,349.265L600.55,348.003L601.468,347.643L602.228,347.987L603.091,345.384L602.435,344.247L602.877,343.459L602.506,343.06L603.579,343.121L603.463,342.145L603.772,341.636L604.189,341.907L604.366,341.232L606.243,341.799L606.722,339.852L606.239,338.332L610.608,339.203L612.932,338.512L613.615,336.291L613.298,335.589L613.807,335.17L614.262,336.767L615.485,337.472L616.281,337.445L615.791,334.734L617.676,335.732L618.51,335.225L618.36,336.025L619.576,337.611L620.142,337.475L620.978,334.198L620.417,332.417L621.376,331.881L622.377,332.795L621.82,331.035L625.613,331.16L626.134,330.098L627.014,329.93L626.481,328.116L626.571,327.49z", // Tripura path is the lower section of this long path, which includes Mizoram
  assam: "M625.316,265.548l4.405,-0.226l2.005,-0.865l1.22,0.243l1.564,-0.968l3.284,0.038l1.574,-0.669l-0.166,-0.812l0.519,-0.522l5.581,0.806l1.156,0.602l0.029,0.534l2.655,1.239l8.589,-1.213l3.697,0.646l4.873,-0.851l2.525,-2.385l1.637,-0.332l-0.249,-1.159l-0.712,-0.466l4.137,-4.119l2.729,-1.798l2.517,-2.993l2.663,-1.165l-0.067,-0.911l-1.187,-1.396l1.075,-0.787l0.622,1.244l0.574,-0.286l1.816,0.72l1.661,-0.688l0.751,1.186l5.822,-2.402l0.181,-0.459l1.738,0.018l1.03,-0.825l1.151,-0.143l0.562,-0.939l4.454,-0.922l7.458,-2.52l1.772,0.761l3.44,-1.04l2.373,-1.986l5.729,-0.513l3.962,0.232l-1.311,2.124l-2.724,2.039l-1.114,1.335l0.19,0.422l-0.772,0.286l0.999,1.125l-0.471,0.411l0.602,0.61l-0.374,0.669l0.969,0.533l0.41,0.952l1.083,0.35l0.218,1.23l-1.054,1.983l0.471,0.345l0.557,-0.704l0.115,0.994l0.622,-0.971l0.864,-0.048l0.474,0.546l0.255,-0.297l1.061,1.767l-2.926,1.987l-0.325,0.754l-0.877,-0.815l-1.415,0.064l-5.652,1.627l-1.932,-1.022l-1.477,1.443l-0.051,2.033l-2.853,0.807l-2.625,1.947l-1.378,-0.332l0,0l-2.233,1.987l-2.319,1.085l-0.933,0.188l-1.503,-0.885l-1.097,0.513l-2.196,3.304l-3.021,1.921l-1.523,0.365l-0.632,-0.54l-0.771,1.261l-0.774,-0.52l-2.016,1.074l-0.143,0.899l-1.428,0.551l-0.221,2.145l-1.263,0.62l-0.904,1.194l-0.592,-0.466l-0.107,-2.179l-0.341,0.138l-2.358,2.57l-0.287,3.04l-1.765,0.466l-2.698,4.003l-0.358,2.631l-0.947,1.707l0.642,2.291l-1.66,0.838l-0.867,1.091l-1.056,-0.437l-1.217,1.262l-0.417,-0.836l0.483,-1.657l-0.661,-1.472l-0.554,0.774l-1.678,0.704l0.466,1.59l-3.457,2.296l-1.917,2.726l-1.892,0.656l-2.504,2.213l1.677,2.162l1.725,0.77l0.427,1.432l-0.688,0.933l0.578,0.912l0,0l-2.23,1.657l-1.384,3.923l-0.814,1.251l-0.952,-0.044l-0.506,0.806l0.354,1.764l-0.586,0.327l0.348,0.523l-0.632,1.085l-0.834,0.545l0.005,1.181l-1.162,0.562l-0.791,-0.786l-0.336,0.264l-0.067,1.774l-0.819,0.824l0.754,0.915l-0.766,2.069l0.825,0.331l-1.2,0.229l0.303,0.358l-0.965,1.677l0.089,2.243l-1.011,0.207l0,0l-1.694,0.201l-0.632,-0.453l-0.165,0.481l-1.106,-0.132l-0.886,0.568l-1.667,-3.741l-1.948,4.34l-1.736,0.579l-0.331,2.074l-1.594,0.194l-0.5,1.791l-1.193,0.397l-0.131,0.545l-1.156,-0.289l-0.372,-2.634l-3.287,0.037l0,0l-2.189,0.063l1.559,-3.399l-1.082,-2.119l-0.003,-1.142l0,0l0.521,-3.999l1.238,-2.076l-1.51,-4.253l1.513,-0.545l2.434,1.833l1.068,-0.056l0.44,-0.658l1.114,0.085l0.338,-0.794l-0.404,-1.307l-0.539,0.312l-0.434,-0.288l0.565,-0.095l-0.344,-0.499l-0.839,0.094l-0.066,-1.55l0,0l0.977,-0.138l0.55,-1.854l1.532,0.221l-0.478,-1.056l2.535,0.583l1.183,-1.552l3.596,-1.104l-1.04,-0.784l0.72,-0.938l-0.203,-1.237l-0.624,-0.072l-0.614,-1.202l-0.495,0.165l-1.159,-1.103l-0.357,0.178l-0.152,-0.653l-1.18,0.49l-0.287,-1.44l-0.804,0.11l2.021,-1.829l0.229,-1.432l-1.33,0.91l-0.787,-0.079l-0.389,-1.349l-1.462,-0.285l-0.947,-1.557l-0.87,-0.223l0.026,-1.057l-1.257,-0.579l-1.347,0.741l-2.733,0.236l-1.785,1.159l-0.199,-3.683l0.7,-1.501l1.192,-0.964l-1.616,-0.124l-0.191,-0.863l3.686,-3.512l-1.469,0.434l-1.643,-0.442l-1.182,0.878l-2.099,0.341l-1.614,-0.215l-1.803,1.085l-1.358,-1.376l0.147,-1.191l-1.477,-0.548l-2.302,1.556l-0.289,2.748l-1.33,1.273l-1.52,-0.903l0.701,-0.652l-0.152,-1.504l-1.471,-0.28l-1.94,2.937l0.777,-0.077l-1.479,1.372l0.863,0.099l0.573,-0.581l-0.112,0.438l-2.118,0.833l-0.667,-0.358l-2.231,0.416l-1.514,2.402l-1.352,0.614l-0.834,-0.161l-0.316,-1.222l0.433,-2.162l-3.482,1.01l-0.35,-0.223l0.749,-0.62l-0.769,0.1l-1.263,0.693l0.744,-1.72l-1.614,0.023l-0.646,-1.579l-0.702,0.115l0.084,0.781l-0.944,-1.005l-1.208,0.354l-0.704,-0.365l-0.832,1.147l-0.98,-0.181l0.179,-1.101l-1.604,0.171l-1.601,1.357l-0.478,-0.35l0.587,-0.658l-1.217,-0.584l-1.828,1.662l0.573,-1.616l-1.495,-1.496l-1.272,0.685l-0.84,-0.656l-0.824,0.1l-1.062,0.94l-3.708,0.782l-1.669,-0.439l-2.979,2.159l0.45,0.343l-0.356,0.489l-1.665,0.584l0.278,1.308l-0.568,0.782l-1.069,0.25l3.26,3.472l-3.848,1.515l0,0l0.395,-2.238l-1.322,-2.29l0.233,-1.328l-0.76,-1.273l1.982,-3.223l-1.017,-0.162l-0.261,-0.457l0.886,-0.318l-0.936,-0.898l0.005,0.77l-0.439,-0.102l-0.494,-1.425l-0.683,0.064l0.667,-0.542l-0.155,-0.745l-1.004,-0.599l0.302,-0.481l-0.517,-0.736l-0.84,-0.273l0,0l0.402,-0.234l-1.029,-0.368l0.973,-0.607l-0.91,-0.13l0.824,-0.548l-0.625,-0.828l0.533,0.3l0.321,-0.332l-0.513,-0.904l1.067,0.428l-0.212,-0.84l0.792,-0.246l0.031,-0.585l1.968,-0.815l-0.273,-0.478l-0.511,0.164l1.133,-1.657l-0.47,-0.729l0.244,-2.355l0.406,-0.167l-0.535,-1.023l0.505,-0.682l-0.507,-1.419l0,0l0.142,-0.868l2.494,0.361l4.922,-0.83l1.114,-0.41l-0.122,-1.023l0.805,-1.15l2.265,0.144l1.401,-1.251l1.428,-0.152l3.927,2.636l3.982,0.875l8.933,-0.311l1.114,-1.054l4.332,0.386l1.934,0.663l1.883,-1.461l2.207,1.196l3.425,-0.824l1.659,0.424l2.998,-1.227l1.459,-1.62l1.031,-0.055l2.31,1.513l1.566,0.28l1.136,-0.351L625.316,265.548zM566.821,300.827l0.257,1.454l-0.65,0.329l0,0L566.821,300.827z",
  arunachal: "M731.183,200.478L731.914,201.487L731.844,202.408L733.425,204.346L734.717,204.329L736.551,203.026L737.326,203.787L736.111,206.021L733.86,206.306L731.91,208.019L730.051,208.463L730.988,209.103L731.89,210.803L730.854,212.126L731.41,212.951L733.549,211.986L736.121,209.648L738.45,209.51L740.787,208.42L739.538,210.647L739.804,211.398L740.62,211.25L741.106,213.521L743.16,216.28L742.375,217.77L739.416,218.643L739.975,219.95L738.248,221.285L737.538,221.098L737.687,221.889L736.327,221.979L735.571,222.673L736.808,223.901L733.952,225.827L735.419,226.539L736.754,226.325L737.499,227.627L738.111,227.458L739.038,225.674L740.396,225.698L742.209,224.527L744.431,224.458L746.69,225.608L747.301,226.854L749.335,227.004L750.548,226.545L751.262,227.613L753.107,228.366L755.617,226.969L757.745,228.815L760.571,229.411L763.669,231.392L762.702,231.497L761.845,232.372L762.06,233.507L761.243,234.617L762.962,234.796L763.055,235.61L764.051,236.003L763.081,236.994L763.368,239.341L761.593,239.521L761.268,238.463L759.903,238.998L755.877,242.033L755.719,243.169L753.945,243.19L752.631,245.21L751.69,245.325L750.521,246.544L751.57,248.916L750.894,250.678L757.688,259.196L757.025,260.084L756.036,259.603L755.067,259.919L752.798,258.415L749.947,257.713L749.627,257.042L750.322,256.581L750.194,255.768L749.584,255.649L748.032,253.507L745.685,252.82L745.331,253.217L743.069,253.118L740.712,255.088L739.363,254.605L733.184,255.326L728.01,257.648L725.392,261.387L723.847,262.237L722.037,262.238L720.021,265.713L718.519,265.12L716.903,267.446L714.844,267.185L712.128,270.613L708.827,271.765L707.129,270.973L707.129,270.973L706.568,269.692L707.319,268.332L706.542,268.043L706.371,266.675L705.74,266.306L707.03,265.626L706.028,261.65L706.028,261.65L707.406,261.981L710.031,260.034L712.884,259.227L712.935,257.194L714.411,255.751L716.343,256.773L721.995,255.146L723.41,255.082L724.287,255.897L724.612,255.143L727.538,253.156L726.478,251.389L726.223,251.686L725.749,251.14L724.885,251.188L724.263,252.159L724.147,251.165L723.591,251.869L723.12,251.524L724.174,249.541L723.956,248.311L722.873,247.961L722.463,247.01L721.494,246.477L721.868,245.807L721.267,245.197L721.737,244.786L720.738,243.662L721.511,243.375L721.32,242.953L722.435,241.618L725.158,239.58L726.469,237.456L722.507,237.224L716.778,237.736L714.405,239.722L710.965,240.762L709.192,240.001L701.734,242.521L697.28,243.443L696.719,244.382L695.567,244.525L694.537,245.35L692.799,245.333L692.618,245.792L686.796,248.194L686.045,247.008L684.384,247.696L682.567,246.977L681.993,247.262L681.371,246.019L680.296,246.805L681.482,248.201L681.55,249.112L678.887,250.276L676.37,253.27L673.641,255.067L669.504,259.187L670.216,259.653L670.465,260.812L668.828,261.144L666.303,263.529L661.43,264.379L657.732,263.733L649.144,264.947L646.488,263.708L646.459,263.173L645.303,262.572L639.722,261.766L639.203,262.288L639.369,263.1L637.795,263.77L634.511,263.732L632.946,264.7L631.727,264.457L629.722,265.322L625.316,265.548L625.316,265.548L625.197,262.57L623.38,261.078L623.107,258.529L624.318,256.927L623.532,255.802L625.153,255.737L625.649,255.255L624.034,254.22L623.921,252.313L622.987,250.232L620.912,250.732L618.916,250.171L615.178,250.478L614.396,249.631L613.279,250.102L611.173,247.741L611.417,246.871L610.937,246.214L612.662,244.319L613.076,242.771L612.777,241.838L612.011,241.316L611.139,241.46L610.574,240.409L613.66,240.338L614.905,241.513L617.901,241.589L618.852,243.51L620.373,244.08L622.075,242.645L623.945,242.929L627.996,240.318L629.398,240.346L630.757,242.43L632.426,241.99L633.133,241.284L634.389,241.775L635.602,240.776L637.154,241.311L638.313,239.834L639.991,239.243L641.827,236.909L639.826,234.991L640.455,233.344L643.399,231.346L644.101,232.135L645.899,231.284L647.71,229.789L648.647,230.6L649.521,229.754L649.256,228.707L654.361,227.908L654.689,226.158L653.412,225.131L655.851,223.436L656.617,221.83L656.476,220.96L657.202,220.731L657.443,219.898L660.287,218.961L661.033,219.546L661.476,218.753L662.592,219.41L664.847,219.439L667.761,218.614L668.9,219.158L670.701,218.141L672.847,219.072L674.814,216.359L674.393,215.765L674.646,214.639L678.833,211.675L680.39,208.294L682.299,206.62L684.107,206.504L684.509,205.52L686.05,204.563L689.36,204.508L691.198,201.38L693.364,202.537L695.099,204.189L695.637,206.189L697.567,205.675L701.514,207.078L700.853,205.97L703.49,206.733L704.101,207.454L707.472,207.621L707.885,208.985L711.639,209.601L712.794,209.525L713.543,208.632L713.893,206.825L715.211,207.129L714.974,204.898L716.23,204.794L716.568,203.647L717.596,203.961L721.245,201.176L721.737,201.701L723.941,200.259L725.937,200.489L729.165,198.38z",
};
const NE_STATES = [
  "assam", "arunachal", "nagaland", "manipur", 
  "mizoram", "tripura", "meghalaya", "sikkim"
];

const stateData = {
  assam: {
    name: "Assam",
    info: "Hub of AgriTech and Tea Industry Innovation",
    startups: 45,
    funding: "₹18 Cr",
  },
  arunachal: {
    name: "Arunachal Pradesh",
    info: "Growing Tourism and Handicraft Ventures",
    startups: 12,
    funding: "₹3.5 Cr",
  },
  nagaland: {
    name: "Nagaland",
    info: "Music, Arts, and Cultural Tourism Startups",
    startups: 15,
    funding: "₹4.2 Cr",
  },
  manipur: {
    name: "Manipur",
    info: "Sports Technology and Sustainable Products",
    startups: 18,
    funding: "₹5.8 Cr",
  },
  mizoram: {
    name: "Mizoram",
    info: "HealthTech and Remote Healthcare Solutions",
    startups: 14,
    funding: "₹4 Cr",
  },
  tripura: {
    name: "Tripura",
    info: "Bamboo Industry and Eco-friendly Products",
    startups: 16,
    funding: "₹4.5 Cr",
  },
  meghalaya: {
    name: "Meghalaya",
    info: "E-commerce and Traditional Handicrafts",
    startups: 22,
    funding: "₹7.2 Cr",
  },
  sikkim: {
    name: "Sikkim",
    info: "Organic Farming and Eco-tourism Innovation",
    startups: 20,
    funding: "₹6.5 Cr",
  },
};


export function NEIndiaMap() {
  const [selectedState, setSelectedState] = useState(null);
  const [hoveredState, setHoveredState] = useState(null);
  const [dbData, setDbData] = useState({});
  const [loading, setLoading] = useState(true);
  

  const handleStateClick = (stateKey) => {
    setSelectedState(selectedState === stateKey ? null : stateKey);
  };
 useEffect(() => {
    fetchStartupStats();
  }, []);

 const fetchStartupStats = async () => {
  try {
    const { data, error } = await supabase
      .from("startups")
      .select("location, current_valuation")
      .eq("is_approved", true);

    if (error) throw error;

    const stats = {};
    NE_STATES.forEach((state) => {
      // FIX 1: Ensure the key name matches what you use in the UI (totalValuation)
      stats[state] = { count: 0, totalValuation: 0 };
    });

    data.forEach((startup) => {
      const locationText = (startup.location || "").toLowerCase();
      const matchedState = NE_STATES.find((state) => locationText.includes(state));

      if (matchedState) {
        stats[matchedState].count += 1;

        const valStr = startup.current_valuation?.toLowerCase() || "";
        
        // FIX 2: Improved Regex to keep decimals like 8.5
        let numericValue = parseFloat(valStr.replace(/[^\d.]/g, "")) || 0;

        // Handle shorthand multipliers
        if (valStr.includes("cr")) {
          numericValue *= 10000000;
        } else if (valStr.includes("lakh")) {
          numericValue *= 100000;
        } else if (valStr.includes("k")) {
          numericValue *= 1000;
        }

        // FIX 3: Update totalValuation (matching the initialization above)
        stats[matchedState].totalValuation += numericValue;
      }
    });

    setDbData(stats);
  } catch (err) {
    console.error("Error fetching map data:", err);
  } finally {
    setLoading(false);
  }
};
 const labelPositions = {
    arunachal: { x: 720, y: 220 },
    assam: { x: 620, y: 280 },
    nagaland: { x: 680, y: 285 },
    manipur: { x: 670, y: 320 },
    mizoram: { x: 645, y: 350 },
    tripura: { x: 615, y: 370 },
    meghalaya: { x: 600, y: 310 },
    sikkim: { x: 535, y: 250 },
  };
const formatCurrency = (val) => {
    if (val >= 10000000) return `₹${(val / 10000000).toFixed(2)} Cr`;
    if (val >= 100000) return `₹${(val / 100000).toFixed(2)} L`;
    return `₹${val.toLocaleString()}`;
  };


  const getColorClass = (key) => {
    const baseColor =
      key === "assam" || key === "manipur" || key === "sikkim" || key === "tripura"
        ? { normal: "fill-emerald-200 stroke-emerald-400", hover: "fill-emerald-400 stroke-emerald-600" }
        : { normal: "fill-cyan-200 stroke-cyan-400", hover: "fill-cyan-400 stroke-cyan-600" };

    if (hoveredState === key || selectedState === key) {
      return baseColor.hover;
    }
    return baseColor.normal;
  };
 if (loading) {
    return (
      <div className="flex flex-col items-center justify-center h-64 gap-4">
        <Loader2 className="w-8 h-8 animate-spin text-cyan-600" />
        <p className="text-slate-500 font-medium">Loading Ecosystem Data...</p>
      </div>
    );
  }
  return (
   
  <div className="relative w-full h-full flex items-center justify-center ">
  {/* Background Decorative Elements */}

  {/* Main Container */}
  <div className="relative  max-w-4xl w-full">
    
    
    {/* SVG Map Container */}
    <div className="relative ">
      <svg
        viewBox="500 180 300 250"
        className="w-full h-full max-w-2xl mx-auto "
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <linearGradient id="mapGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stopColor="#06b6d4" stopOpacity="0.15" />
            <stop offset="50%" stopColor="#10b981" stopOpacity="0.1" />
            <stop offset="100%" stopColor="#8b5cf6" stopOpacity="0.15" />
          </linearGradient>
          
          <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
            <path d="M 40 0 L 0 0 0 40" fill="none" stroke="rgba(100,116,139,0.1)" strokeWidth="1"/>
          </pattern>
        </defs>
        {/* Render each state path */}
        {Object.entries(statePaths).map(([key, d]) => (
          <path
            key={key}
            id={`IN-${key.toUpperCase()}`}
            title={stateData[key].name}
            d={d}
            className={`transition-all duration-200 cursor-pointer ${getColorClass(key)} ${
              hoveredState === key ? 'opacity-100 brightness-110 saturate-125' : 'opacity-90'
            }`}
            strokeWidth="1.5"
            stroke="white"
            onClick={() => handleStateClick(key)}
            onMouseEnter={() => setHoveredState(key)}
            onMouseLeave={() => setHoveredState(null)}
          />
        ))}

        {/* State Labels */}
        {Object.entries(stateData).map(([key, data]) => (
          <text
            key={key}
            x={labelPositions[key].x}
            y={labelPositions[key].y}
            className="pointer-events-none select-none"
            textAnchor="middle"
            style={{
              fontSize: "10px",
              fontWeight: 700,
              fill: '#1e293b',
              textShadow: '0 1px 2px rgba(255,255,255,0.8)',
              letterSpacing: '0.5px'
            }}
          >
            {data.name}
          </text>
        ))}
      </svg>

      {/* Map Legend */}
       
    </div>

    {/* Info Popup */}
    <AnimatePresence>
      {selectedState && (
        <motion.div
          initial={{ opacity: 0, scale: 0.9, y: 20 }}
          animate={{ opacity: 1, scale: 1, y: 0 }}
          exit={{ opacity: 0, scale: 0.9, y: 20 }}
          className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl shadow-2xl border border-slate-200/80 backdrop-blur-sm z-20 min-w-[320px]"
        >
          {/* Header with gradient */}
          <div className="bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-t-2xl p-6 text-white">
            <button
              onClick={() => setSelectedState(null)}
              className="absolute top-4 right-4 p-2 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-200 backdrop-blur-sm"
            >
              <X className="w-4 h-4" />
            </button>
            
            <div className="flex items-center gap-3">
              <div className="w-12 h-12 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30">
                <MapPin className="w-6 h-6" />
              </div>
              <div>
                <h3 className="text-2xl font-bold capitalize">{selectedState}</h3>
                <p className="text-cyan-50 text-sm opacity-90">Startup Ecosystem</p>
              </div>
            </div>
          </div>
          
          {/* Content */}
          <div className="p-6">
            <p className="text-slate-600 text-sm leading-relaxed mb-6 border-l-4 border-cyan-200 pl-4">
              {stateData[selectedState].info}
            </p>
            
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-gradient-to-br from-cyan-50 to-cyan-100 rounded-xl p-4 border border-cyan-200/60">
                <div className="flex items-center gap-2 mb-2">
                  <Users className="w-4 h-4 text-cyan-600" />
                  <span className="text-xs font-semibold text-cyan-700 uppercase tracking-wide">Startups</span>
                </div>
                <div className="text-2xl font-bold text-cyan-900">{dbData[selectedState]?.count || 0}</div>
                <div className="text-xs text-cyan-600 mt-1">Registered Startups</div>
              </div>
              
              <div className="bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl p-4 border border-emerald-200/60">
                <div className="flex items-center gap-2 mb-2">
                  <TrendingUp className="w-4 h-4 text-emerald-600" />
                  <span className="text-xs font-semibold text-emerald-700 uppercase tracking-wide">Total Valuation</span>
                </div>
                <div className="text-2xl font-bold text-emerald-900">{formatCurrency(dbData[selectedState]?.totalValuation || 0)}</div>
                <div className="text-xs text-emerald-600 mt-1">Total investment</div>
              </div>
            </div>
          </div>
        </motion.div>
      )}
    </AnimatePresence>

    {/* Footer */}
    
  </div>
</div>
 
  );
}


